Sub FormatExcel()
    On Error Resume Next
    Columns("B").SpecialCells(xlCellTypeBlanks).EntireRow.Delete
    a = Cells(Rows.Count, 1).End(xlUp).Row


For i = 3 To a
        For j = 10 To 15
If Cells(i, 1) <> Cells(i - 1, 1) And IsEmpty(Cells(i, 8)) Then
Cells(i, j - 8).Copy Cells(i - 1, j)
End If
Next j
Next i
Application.CutCopyMode = False
Cells(1, 1).Select

For i = 3 To a
If Cells(i, 1) <> Cells(i - 1, 1) And IsEmpty(Cells(i - 1, 8)) Then
Cells(i, 1).EntireRow.Delete
End If
Next i

a = Cells(Rows.Count, 1).End(xlUp).Row

For i = a To 2 Step -1
If Cells(i, 14) = "Unavailable" Or IsEmpty(Cells(i, 10)) Then
Cells(i, 1).EntireRow.Delete
End If
Next i

Columns(15).EntireColumn.Delete
Columns(13).EntireColumn.Delete
Columns(12).EntireColumn.Delete
Columns(10).EntireColumn.Delete
Columns(8).EntireColumn.Delete
Columns(7).EntireColumn.Delete
Columns(6).EntireColumn.Delete
Columns(5).EntireColumn.Delete
Columns(4).EntireColumn.Delete

a = Cells(Rows.Count, 1).End(xlUp).Row
Dim TextStrng As String
Dim Result() As String
Dim TimeResult As Variant
Dim Invoice As Variant
Cells(1, 7) = "StartDate"
Cells(1, 8) = "StartTime"
Cells(1, 9) = "EndDate"
Cells(1, 10) = "EndTime"
Cells(1, 11) = "ElapsedTime(hours)"
Cells(1, 12) = "InvoiceAmount"
Cells(1, 13) = "OriginalInfo"
Cells(1, 14) = "Location"
Cells(1, 15) = "Summary"

For i = 2 To a

TextStrng = Cells(i, 2)
Result() = Split(TextStrng)
Cells(i, 7) = Result()
Next i

For j = 2 To a

TextStrng = Cells(j, 2)
TimeResult = format(Right(TextStrng, 11), "Short Time")
Cells(j, 8) = TimeResult
Next j

For k = 2 To a

TextStrng = Cells(k, 3)
Result() = Split(TextStrng)
Cells(k, 9) = Result()
Next k

For m = 2 To a

TextStrng = Cells(m, 3)
TimeResult = format(Right(TextStrng, 11), "Short Time")
Cells(m, 10) = TimeResult
Next m

For n = 2 To a
Cells(n, 11) = DateDiff("s", Cells(n, 2), Cells(n, 3)) / 3600

Next n

For p = 2 To a

If Left(Cells(p, 4), 1) <> "$" Then
Invoice = FormatCurrency(Cells(p, 4))
Cells(p, 12) = Invoice
Else
TextStrng = Cells(p, 4)
Result() = Split(TextStrng)
Cells(p, 12) = Result()
TextStrng = Cells(p, 12)
Invoice = Right(TextStrng, Len(TextStrng) - 1)
Cells(p, 12) = FormatCurrency(CDec(Invoice))
End If
Next p

For q = 2 To a
Cells(q, 13) = Cells(q, 4)
Next q

For r = 2 To a
Cells(r, 14) = Cells(r, 5)
Next r

For s = 2 To a
Cells(s, 15) = Cells(s, 6)
Next s

Columns(6).EntireColumn.Delete
Columns(5).EntireColumn.Delete
Columns(4).EntireColumn.Delete
Columns(3).EntireColumn.Delete
Columns(2).EntireColumn.Delete

Columns("H:H").Insert Shift:=xlToRight, _
      CopyOrigin:=xlFormatFromLeftOrAbove
Cells(1, 8) = "AdminHours?"

a = Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To a
Cells(i, 2) = format(Cells(i, 2), "mm/dd/yyyy")
Cells(i, 4) = format(Cells(i, 4), "mm/dd/yyyy")
Next i
With ActiveSheet.sort
     .SortFields.Add Key:=Range("A1"), Order:=xlAscending
     .SortFields.Add Key:=Range("B1"), Order:=xlAscending
     .SetRange ActiveSheet.UsedRange
     .Header = xlYes
     .Apply
End With

a = Cells(Rows.Count, 1).End(xlUp).Row
b = Application.Sheets.Count
n = 1 'Unique calendars
For i = 3 To a
If Cells(i, 1) <> Cells(i - 1, 1) Then
n = n + 1
End If
Next i

For b = Application.Sheets.Count To n - 1
Sheets.Add After:=Sheets(Sheets.Count)
Sheets(b).Range("A1:K1").Copy Sheets(b + 1).Range("A1")
Next b
Sheets(1).Activate


For Z = 1 To b - 1
For i = a To 2 Step -1
If Sheets(Z).Cells(i, 1) <> Sheets(Z).Cells(2, 1) Then
Cells(i, 1).EntireRow.Copy Destination:=Sheets(Z + 1).Range("A" & Rows.Count).End(xlUp).Offset(1)
Sheets(Z).Activate
Cells(i, 1).EntireRow.Delete
End If
Next i
Next Z

For Z = 1 To b
Sheets(Z).Activate
With ActiveSheet.sort
     .SortFields.Add Key:=Range("A1"), Order:=xlAscending
     .SortFields.Add Key:=Range("B1"), Order:=xlAscending
     .SetRange ActiveSheet.UsedRange
     .Header = xlYes
     .Apply
End With
Columns("A:K").AutoFit
Range("A1", Range("A1").End(xlDown)).RowHeight = 15
Range("I:I").ColumnWidth = 25
ActiveSheet.Name = Range("a2")
Next Z

MsgBox "Please double check for and correct the following:" & vbNewLine & "Non-dollar or negative amounts in Column G" & vbNewLine & "Strange symbols in Column I" & vbNewLine & "If the amount shown in Column G does not match its corresponding value in Column I" & vbNewLine & "Finally, put a lowercase 'x' next in Column H for any task that should be designated as administrative hours"
End Sub

Sub summary()
Worksheets.Add before:=Worksheets(1)
Dim TextString As Variant
Cells(1, 1) = "Summary Data"
Cells(2, 1) = "Employee Name"
Cells(2, 2) = "Commission (Enter as Decimal)"
Cells(2, 3) = "Admin Hours"
Cells(2, 4) = "Walking/Sitting Hours"
Cells(2, 5) = "Total Hours Worked"
Cells(2, 6) = "Total Pay"
For i = 2 To Sheets.Count
Cells(i + 1, 1) = Sheets(i).Name
Cells(i + 1, 2) = InputBox("What is the Commission for " & Cells(i + 1, 1) & "? (Please enter as a decimal i.e. 0.67)")
Dim ws As Worksheet
Set ws = Sheets(i)
Cells(i + 1, 3) = Application.WorksheetFunction.SumIf(ws.Range("H:H"), "<>", ws.Range("F:F"))
Cells(i + 1, 5) = Application.WorksheetFunction.Sum(ws.Range("F:F"))
Cells(i + 1, 4) = Cells(i + 1, 5) - Cells(i + 1, 3)
Cells(i + 1, 6) = (Cells(i + 1, 3) * 8.25) + Application.WorksheetFunction.SumIf(ws.Range("H:H"), "", ws.Range("G:G")) * Cells(i + 1, 2)
Cells(i + 1, 6) = CCur(Cells(i + 1, 6))
Next i

Columns("A:F").AutoFit
Range("A1:F1").Merge
Range("A1:F1").HorizontalAlignment = xlCenter
Range("A1").RowHeight = 30
Range("A1").Font.Size = 20
Range("A1:F1").Style = "Heading 1"
ActiveSheet.Name = Range("a1")
End Sub
